---

- name: set timezone to {{ timezone }}
  timezone:
    name: "{{ timezone }}"
  when: set_timezone is true

- name: install packages for Debian family
  block:
    - name: install default packages for Debian family
      apt:
        update_cache: yes
        name: "{{ debian_packages }}"

    - name: install ext packages for Debian family
      apt:
        name: "{{ debian_ext_packages }}"
      when: debian_ext_packages|length>0
  when: ansible_os_family == "Debian"

- name: install packages for RedHat family
  block:
    - name: install default packages for RedHat family
      yum:
        update_cache: yes
        name: "{{ redhat_packages }}"

    - name: install ext packages for RedHat family
      yum:
        name: "{{ redhat_ext_packages }}"
      when: redhat_ext_packages|length>0
  when: ansible_os_family == "RedHat"

...
